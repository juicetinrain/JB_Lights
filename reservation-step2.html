<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Reserve — Step 2: Date & Time | JB Lights & Sound</title>
  <link rel="stylesheet" href="style.css">
  <script src="reservation.js" defer></script>
</head>
<body>
  <nav class="jb-navbar">
    <div class="container">
      <a class="brand" href="index.html"><img src="jb-logo.png" alt=""><span>JB Lights & Sound</span></a>
    </div>
  </nav>

  <main class="jb-page">
    <div class="jb-progress jb-card">
      <div style="flex:1">
        <div class="step"><div class="bar" style="width:50%"></div></div>
        <div class="labels"><span>Package</span><span>Date</span></div>
      </div>
    </div>

    <section class="jb-card">
      <div class="jb-title">Pick event date & time</div>
      <div class="jb-sub">We’ll check a quick availability hint. Final confirmation after submission.</div>

      <div style="display:grid;gap:14px">
        <div>
          <label class="form-label fw-semibold">Event Date</label>
          <input id="eventDate" type="date" class="input-lg" />
          <div style="margin-top:8px"><span id="availabilityBox" class="badge-check" style="padding:6px 10px;border-radius:999px">No date</span></div>
        </div>

        <div>
          <label class="form-label fw-semibold">Event Time (approx.)</label>
          <input id="eventTime" type="time" class="input-lg" />
          <div class="hint" style="margin-top:6px">Start time (approx). You can update later with staff.</div>
        </div>
      </div>

      <div class="jb-foot-fixed">
        <div></div>
        <div style="display:flex;gap:12px">
          <a class="btn btn-secondary-jb btn-large" href="reservation-step1.html">Back</a>
          <button class="btn btn-primary-jb btn-large" id="next2">Next: Address</button>
        </div>
      </div>
    </section>
  </main>

  <script>
    const dateEl = document.getElementById('eventDate');
    const availBox = document.getElementById('availabilityBox');

    function updateAvailability(){
      const val = dateEl.value;
      const check = window.jbCheckAvailability(val);
      availBox.textContent = check.msg;
      availBox.className = check.ok ? 'badge-available' : 'badge-check';
    }

    // restore saved data & wire save
    document.addEventListener('DOMContentLoaded', ()=>{
      const data = window.jbRes.read() || {};
      if(data.date) dateEl.value = data.date;
      if(data.time) document.getElementById('eventTime').value = data.time;
      updateAvailability();
    });

    dateEl.addEventListener('change', ()=>{
      updateAvailability();
      const data = window.jbRes.read() || {};
      data.date = dateEl.value;
      window.jbRes.write(data);
    });

    document.getElementById('eventTime').addEventListener('change', (e)=>{
      const data = window.jbRes.read() || {};
      data.time = e.target.value;
      window.jbRes.write(data);
    });

    document.getElementById('next2').addEventListener('click', ()=>{
      const data = window.jbRes.read() || {};
      if(!data.date){
        alert('Please pick an event date.');
        return;
      }
      const chk = window.jbCheckAvailability(data.date);
      if(!chk.ok && !confirm(chk.msg + ' — do you want to continue and confirm with staff?')) return;
      window.location.href = 'reservation-step3.html';
    });
  </script>
</body>
</html>